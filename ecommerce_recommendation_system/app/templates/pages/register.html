{% extends 'layouts/base.html' %}
{% block title %}Register - SaNeMart{% endblock %}
{% block content %}
<div class="form-container">
    <h2>Register</h2>
    <form id="register-form" onsubmit="handleRegister(event)">
        <input type="text" id="name" placeholder="Name" required />
        <input type="email" id="email" placeholder="Email" required />
        <input type="password" id="password" placeholder="Password" required />
        <button type="submit">Register</button>
    </form>
    <p id="register-error" style="color: red; margin-top: 10px; display: none;"></p>
</div>

<script>
  async function handleRegister(event) {
    event.preventDefault();

    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;

    try {
      const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);

      // Optionally update the display name
      await userCredential.user.updateProfile({ displayName: name });

      // Registration successful, save user info or redirect
      sessionStorage.setItem('userEmail', userCredential.user.email);
      sessionStorage.setItem('userName', name);

      window.location.href = "{{ url_for('main.home') }}";
    } catch (error) {
      const errorMsg = document.getElementById('register-error');
      errorMsg.textContent = error.message;
      errorMsg.style.display = 'block';
    }
  }
</script>
{% endblock %}
