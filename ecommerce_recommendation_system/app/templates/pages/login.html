{% extends 'layouts/base.html' %}
{% block title %}Login - SaNeMart{% endblock %}
{% block content %}
<div class="form-container">
    <h2>Login</h2>
    <form id="login-form" onsubmit="handleLogin(event)">
        <input type="email" id="email" placeholder="Email" required />
        <input type="password" id="password" placeholder="Password" required />
        <button type="submit">Login</button>
    </form>
    <p id="login-error" style="color: red; margin-top: 10px; display: none;"></p>
</div>

<script>
  async function handleLogin(event) {
    event.preventDefault();

    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;

    try {
      const userCredential = await firebase.auth().signInWithEmailAndPassword(email, password);
      // Login successful, save user info in sessionStorage or redirect
      sessionStorage.setItem('userEmail', userCredential.user.email);
      window.location.href = "{{ url_for('main.home') }}";
    } catch (error) {
      const errorMsg = document.getElementById('login-error');
      errorMsg.textContent = error.message;
      errorMsg.style.display = 'block';
    }
  }
</script>
{% endblock %}
